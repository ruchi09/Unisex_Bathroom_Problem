
// Sudo code for Unisex Bathroom Problem




//Thread Functions Used

1) timer()            // Timeout Function to prevent starvation
2) GoIn()             // Sends people inside bathroom from queue
3) UsingTime()        // Defines the time a person stays inside bathroom
4) GeneratePeople()   // Generates people to use bathroom at random time





void timer()
{
  while(1)
  {
    1) Wait till either timeout value is reached or given gender is done
       using bathroom.

    2)If bathroom is still occupied, wait till remaining people exits.

    3)Allocate bathroom to the other gender.
  }

}



void GeneratePeople()
{
  while(1)
  {

    1) if(rand()%2==0)
          MalesInQueue++;

       else
          FemalesInQueue++;


      2)sleep for a random time
  }

}




int GoIn()
{

  while(1)
  {
    while(GenderUsingBathroom==MALE && MalesInQueue>0)
    {
      sem_wait(bathroom);
      MalesInQueue--;
      PeopleInBathroom++;
      pthread_create : UsingTime();
    }

    while(PeopleInBathroom>0)        
      sleep(1);

    while(GenderUsingBathroom==FEMALE && FemalesInQueue>0)
    {
      sem_wait(bathroom)
      FemalesInQueue--;
      PeopleInBathroom++;
      pthread_create: UsingTime();
    }

    while(PeopleInBathroom>0)        // Waiting for remaining ladies to come out
      sleep(1);
  }
}



int UsingTime()
{
  sleep(rand()%2+1);
  PeopleInBathroom--;

  sem_post(&bathroom);
}
